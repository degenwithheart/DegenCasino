import{r as s,R as Ae,j as A}from"./three-D4AtYCWe.js";import{av as me,aw as de,aP as fe,az as pe,W as ye,ay as be,ax as Se,G as T,aR as Me,aB as Ce,aC as Pe,aD as Ie}from"./index-eL7pTMGs.js";import{G as we}from"./GameStatsHeader-BAMe0qyx.js";import{u as W}from"./useGameMeta-BoUQYdhj.js";import{G as Be}from"./GameRecentPlaysHorizontal-DwRhmHlC.js";import{G as Te}from"./GameControlsSection-vCoWFXil.js";import"./react-vendor-faCf7XlP.js";import"./blockchain-C0nfa7Sw.js";import"./physics-audio-DLMfKFaI.js";const Re="/assets/lose-Pg3x1oHK.mp3",Ee="data:audio/mpeg;base64,//uUZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAAFoACioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi//////////////////////////////////////////////////////////////////8AAAA8TEFNRTMuMTAwBK8AAAAAAAAAADUgJALCjQABzAAABaBVoENUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//vEZAAAAZYTUh094AgAAA/woAABFNCvQ7ndgEAAAD/DAAAAA/wAA3ilMsavdn4LmXOMrHBTk7MtcCbjjVcB5VjZ7K9n3Aiahx8P35/cUDBc+H5zxBBAgAAAAAUCgPFi4MgAAAQhGYXhIYHB2YZAkqiYCDCZREgdBTgZFo6bLrSaVKKZTE+aaDOYZjARPYYVgIZpDiYNAUcXTHTBhg0qCvQxUvMukwaHGblgCUTHUQwpTMkC0RX/AgGgsw5ZBh5oQBKlpkAGnnPIUOUmI2kkSOdF2EJVZl8ovX8YEl7iUMPyB0mHTT/S6t////DcvgOL4Re/Psppq8ZPdAYKRZWLABAEDMaj6hQAgAAAAuyKhwCgEwYBjDAFAQ3HRoABAY/KBsiKmHC2YtJQCFBhURBiABAZMNgMwMEgMhC0AYPgYvZgFhkBhwggY2CIBSQDJwMJhYAgSgYRBYGERoA8JCPQsiAw6IQbDCZgY1AQAQcCyEOGRMLnRyzi1QDg2BgkDhloGxANkBCMgJAkDDogAiJQDgV+TpExzysThFAMCA0BwOBuaACCAFwODbL+eTMz6CjQRyISCgRSQrcUELT/uib0jSw5gyo+iDjLEqRAZX/059Bjybm5gRhJjLE2Sw5JMEkQIn//7Ghm5uYMaJpm6CBVICVCeIcVydIaWiLE0ViZ/////5otM3Uh////yiVSaMieJkSWWJsfh/CVyunN0L0TVCkSQUuJ0uMJPIcElEiVVVV6pJsFNBTcgrgV4KbFNyCuBTwUXFFZBTAU+KLxFExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//uUZNEACJqCz25yoJAAAA/wwAAAB3Q/J3zzACgAAD/DgAAEqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",ke="/assets/play-lr1BXNxD.mp3",De="/assets/win-BSUZMT9R.mp3",f=800,p=600,R=200,J=2500,O=50;function Ve(){const N=me(),[m,H]=de(),G=fe(),[L,j]=s.useState(-1),[d,U]=s.useState(!1),[ne,K]=s.useState(null),F=pe("magic8ball"),[Ne,re]=s.useState(0),[ve,se]=s.useState(0),[Ge,oe]=s.useState(0),{mobile:ie}=ye(),[n,y]=s.useState({currentNumber:0,targetNumber:0,isAnimating:!1,animationProgress:0,particles:[],randomSequence:[],currentSequenceIndex:0}),{settings:h}=be(),E=h.quality!=="low",X=h.quality==="high"||h.quality==="ultra",_=h.quality!=="low",Y=h.quality==="ultra"?O:h.quality==="high"?Math.floor(O*.75):h.quality==="medium"?Math.floor(O*.5):0,I=h.enableEffects,u=h.enableMotion,k=s.useRef(null),g=s.useRef(),w=s.useRef(0),x=Se({win:De,play:ke,lose:Re,tick:Ee}),v=2;Ae.useMemo(()=>[1,2,5,10,20],[]);const le=v*m;Ae.useMemo(()=>G.maxPayout/v,[G.maxPayout,v]);const $=le>G.maxPayout,z=T.useGame();s.useEffect(()=>{y(e=>({...e,currentNumber:0,targetNumber:0,isAnimating:!1,animationProgress:0,particles:[],randomSequence:[],currentSequenceIndex:0}))},[]);const ee=s.useCallback(e=>{if(!u)return;w.current===0&&(w.current=e);const q=e-w.current,l=Math.min(q/J,1),r=80,a=20,B=Math.min(Math.floor(q/r),a-1);y(b=>{const i=I?b.particles.map(c=>({...c,x:c.x+c.vx,y:c.y+c.vy,life:c.life-1,vy:c.vy+.1})).filter(c=>c.life>0):[];return l>=1||B>=a-1?{...b,isAnimating:!1,animationProgress:1,particles:i,currentSequenceIndex:a-1}:(g.current=requestAnimationFrame(ee),{...b,animationProgress:l,particles:i,currentSequenceIndex:B})})},[J,u,I,E]),ue=s.useCallback(e=>{if(!u){y(a=>({...a,targetNumber:e,isAnimating:!1,animationProgress:1,particles:[],randomSequence:[e],currentSequenceIndex:0}));return}const q=[],l=20,r=typeof e=="string"?e:e===1?"Win":"Lose";for(let a=0;a<l-1;a++)q.push("Thinking...");q.push(r),y({currentNumber:0,targetNumber:e,isAnimating:!0,animationProgress:0,particles:[],randomSequence:q,currentSequenceIndex:0}),w.current=0,g.current=requestAnimationFrame(ee)},[u]),qe=s.useCallback((e,q,l)=>{if(!E||Y===0)return;const r=[];for(let a=0;a<Y;a++)r.push({x:e,y:q,vx:(Math.random()-.5)*10,vy:(Math.random()-.5)*10-5,life:60+Math.random()*60,maxLife:120,color:l,size:2+Math.random()*4});y(a=>({...a,particles:[...a.particles,...r]}))},[E,Y]),ce=s.useCallback(({ctx:e,size:q})=>{e.clearRect(0,0,q.width,q.height);const r=performance.now()*.001,a=e.createRadialGradient(q.width/2,q.height/2,0,q.width/2,q.height/2,Math.max(q.width,q.height)/2);a.addColorStop(0,"#1a1a2e"),a.addColorStop(.5,"#16213e"),a.addColorStop(1,"#0f0f23"),e.fillStyle=a,e.fillRect(0,0,q.width,q.height),e.save(),e.globalAlpha=.15,e.fillStyle="rgba(212, 165, 116, 0.3)",e.font="120px serif",e.textAlign="center",e.save(),e.translate(q.width*.12,q.height*.15),e.rotate(-15*Math.PI/180),e.fillText("‚öÉ",0,0),e.restore(),e.fillStyle="rgba(184, 51, 106, 0.25)",e.font="100px serif",e.save(),e.translate(q.width*.88,q.height*.85),e.rotate(25*Math.PI/180),e.fillText("‚öÑ",0,0),e.restore(),e.fillStyle="rgba(139, 90, 158, 0.2)",e.font="60px serif",e.save(),e.translate(q.width*.75,q.height*.25),e.rotate(45*Math.PI/180),e.fillText("‚öÇ",0,0),e.restore(),e.save(),e.translate(q.width*.25,q.height*.75),e.rotate(-30*Math.PI/180),e.fillText("‚öÅ",0,0),e.restore(),e.fillStyle="rgba(212, 165, 116, 0.15)",e.font="40px serif";const B=["‚öÄ","‚öÅ","‚öÇ","‚öÉ","‚öÑ","‚öÖ"];for(let t=0;t<8;t++){const o=t*q.width/8+q.width/16,P=q.height*.3+Math.sin(t*.8)*60;e.save(),e.translate(o,P),e.rotate(t*45*Math.PI/180),e.fillText(B[t%B.length],0,0),e.restore()}e.restore();const b=q.width/f,i=q.height/p,D=Math.min(b,i),c=(q.width-f*D)/2,ge=(q.height-p*D)/2;if(e.save(),e.translate(c,ge),e.scale(D,D),_){e.strokeStyle="rgba(138, 43, 226, 0.3)",e.lineWidth=2;for(let t=0;t<8;t++){const o=u?(r*1+t*Math.PI/4)%(Math.PI*2):t*Math.PI/4,P=u?150+Math.sin(r*2+t)*50:150,Q=f/2+Math.cos(o)*P,V=p/2+Math.sin(o)*P;e.beginPath(),e.arc(Q,V,30+t*10,0,Math.PI*2),e.stroke()}}if(X){e.fillStyle="rgba(255, 215, 0, 0.6)",e.font="24px serif",e.textAlign="center";const t=["‚ú¶","‚úß","‚ú©","‚ú™","‚ú´","‚ú¨","‚ú≠","‚úÆ","‚úØ","‚ú∞"];for(let o=0;o<10;o++){const P=o*Math.PI/5,Q=u?Math.sin(r*.1+o)*200+f/2:Math.cos(P)*200+f/2,V=u?Math.cos(r*.1+o)*150+p/2:Math.sin(P)*150+p/2;e.save(),e.translate(Q,V);const he=u?r*1.5+o:o*.5;e.rotate(he),e.fillText(t[o%t.length],0,0),e.restore()}}E&&I&&n.particles.forEach(t=>{const o=t.life/t.maxLife;e.save(),e.globalAlpha=o,e.fillStyle=t.color,e.beginPath(),e.arc(t.x,t.y,t.size,0,Math.PI*2),e.fill(),e.restore()});const S=f/2,M=p/2,Z=e.createRadialGradient(S,M,0,S,M,R/2+20);Z.addColorStop(0,"rgba(212, 165, 116, 0.8)"),Z.addColorStop(1,"rgba(212, 165, 116, 0)"),e.fillStyle=Z,e.beginPath(),e.arc(S,M,R/2+20,0,Math.PI*2),e.fill(),e.fillStyle="#000000",e.beginPath(),e.arc(S,M,R/2,0,Math.PI*2),e.fill(),e.strokeStyle="#d4a574",e.lineWidth=4,e.beginPath(),e.arc(S,M,R/2,0,Math.PI*2),e.stroke(),e.strokeStyle="rgba(139, 90, 158, 0.6)",e.lineWidth=2,e.beginPath(),e.arc(S,M,R/2-10,0,Math.PI*2),e.stroke();let C="-";n.isAnimating?n.randomSequence.length>0&&n.currentSequenceIndex<n.randomSequence.length?C=n.randomSequence[n.currentSequenceIndex].toString():n.targetNumber!==0&&n.targetNumber!==""?C=n.targetNumber.toString():C="Thinking...":n.targetNumber!==0&&n.targetNumber!==""?C=n.targetNumber.toString():d&&L>=0?C=L===1?"Win":"Lose":N.isPlaying&&(C="Thinking..."),e.fillStyle="#d4a574",e.font=`bold ${R*.25}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(C,S,M),e.restore()},[n,d,N.isPlaying,ne,L,E,X,_,I,u]),te=async()=>{if(m<=0){console.error("‚ùå BLOCKED: Cannot play with zero wager");return}U(!1),j(-1),K(null),y(i=>({...i,currentNumber:0,targetNumber:0,isAnimating:!1,animationProgress:0,particles:[],randomSequence:[],currentSequenceIndex:0})),w.current=0,g.current&&(cancelAnimationFrame(g.current),g.current=void 0),x.play("play");const e=[1,2,5,10,20];console.log("ÔøΩ MAGIC 8-BALL BET ARRAY DEBUG:",{betArray:e,nonZeroCount:e.filter(i=>i>0).length,maxBet:Math.max(...e),wager:m}),await z.play({wager:m,bet:e});const q=await z.result(),l=q.payout>0;K(l?"win":"lose");const r=Math.floor(Math.random()*100)+1;console.log("ÔøΩ MAGIC 8-BALL RESULT:",{resultIndex:q.resultIndex,payout:q.payout,multiplier:q.multiplier,luckyNumber:r,win:l}),j(r);const a=q.payout-m;F.updateStats(a),setTimeout(()=>ue(l?"Win":"Lose"),u?50:0);const b=u?J+100:100;setTimeout(()=>{U(!0),se(i=>i+1),re(i=>i+(q.payout-m)),l&&oe(i=>i+1),console.log("üé≤ ANIMATION COMPLETE - Final result:",r),l?(x.play("win"),I&&(k.current?.winFlash("#00ff00",1.5),qe(f/2,p/2,"#ffd700"),k.current?.screenShake(1,600))):(x.play("lose"),I&&(k.current?.loseFlash("#ff4444",.8),qe(f/2,p/2,"#ff6b6b"),k.current?.screenShake(.5,400)))},b)},ae=()=>{U(!1),j(-1),K(null),y(e=>({...e,currentNumber:0,targetNumber:0,isAnimating:!1,animationProgress:0,particles:[],randomSequence:[],currentSequenceIndex:0})),w.current=0,g.current&&(cancelAnimationFrame(g.current),g.current=void 0)};return s.useEffect(()=>()=>{g.current&&cancelAnimationFrame(g.current)},[]),A.jsxs(A.Fragment,{children:[A.jsx(T.Portal,{target:"recentplays",children:A.jsx(Be,{gameId:"magic8ball"})}),A.jsx(T.Portal,{target:"stats",children:A.jsx(we,{gameName:"Magic 8-Ball",gameMode:"2D",rtp:"95",stats:F.stats,onReset:F.resetStats,isMobile:ie})}),A.jsx(T.Portal,{target:"screen",children:A.jsxs("div",{style:{width:"100%",height:"100%",position:"relative",background:"linear-gradient(135deg, #0a0511 0%, #0d0618 25%, #0f081c 50%, #0a0511 75%, #0a0511 100%)",perspective:"100px"},children:[A.jsx("div",{style:{position:"absolute",top:"20px",left:"20px",right:"20px",bottom:"120px",borderRadius:"10px",overflow:"hidden",border:"2px solid rgba(212, 165, 116, 0.4)"},children:A.jsx(T.Canvas,{style:{width:"100%",height:"100%"},render:ce})}),A.jsx(Te,{children:A.jsxs("div",{style:{flex:"1",height:"100%",background:"linear-gradient(135deg, rgba(10, 5, 17, 0.9) 0%, rgba(139, 90, 158, 0.1) 50%, rgba(10, 5, 17, 0.9) 100%)",borderRadius:"12px",border:"2px solid rgba(212, 165, 116, 0.5)",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:"8px 16px",boxShadow:"0 4px 16px rgba(10, 5, 17, 0.4), inset 0 1px 0 rgba(212, 165, 116, 0.2)",backdropFilter:"blur(10px)",position:"relative"},children:[A.jsx("div",{style:{fontSize:"14px",fontWeight:"bold",color:"#d4a574",textShadow:"0 2px 4px rgba(0, 0, 0, 0.3)",marginBottom:"4px"},children:"MAGIC 8-BALL"}),A.jsxs("div",{style:{fontSize:"12px",color:"rgba(212, 165, 116, 0.9)",fontWeight:"600",textAlign:"center"},children:["50/50 Chance ‚Ä¢ ",v,"x Multiplier"]})]})}),A.jsx(Me,{ref:k,style:{position:"absolute",top:0,left:0,right:0,bottom:0,pointerEvents:"none",zIndex:1e3},...W("magic8ball")&&{title:W("magic8ball").name,description:W("magic8ball").description}})]})}),A.jsxs(T.Portal,{target:"controls",children:[A.jsx(Ce,{wager:m,setWager:H,onPlay:d?ae:te,playDisabled:N.isPlaying||!d&&n.isAnimating||$,playText:d?"Ask Again":"Ask the Magic 8-Ball"}),A.jsx(Pe,{onPlay:d?ae:te,playDisabled:N.isPlaying||!d&&n.isAnimating||$,playText:d?"Ask Again":"Ask the Magic 8-Ball",children:A.jsx(Ie,{value:m,onChange:H})})]})]})}export{Ve as default};
